CREATE OR REPLACE VIEW p_base_vdp_queries_pattern AS SELECT base_vdp_queries_patter.database_0 AS database_0, base_vdp_queries_patter.username AS username, replacemap(base_vdp_queries_patter.requesttype, 'requesttype_monitor_vdp_queries') AS requesttype, trim(elements) AS vdpview, base_vdp_queries_patter.useragent AS useragent, base_vdp_queries_patter.accessinterface AS accessinterface, base_vdp_queries_patter.clientip AS clientip, formatdate('yyyy/MM/dd', base_vdp_queries_patter.starttime) AS incomingdate, formatdate('yyyy/MM/dd/HH', base_vdp_queries_patter.starttime) AS incominghour, base_vdp_queries_patter.duration AS duration, base_vdp_queries_patter.waitingtime AS waitingtime, case WHEN (base_vdp_queries_patter.numrows = '-1') THEN 0 ELSE base_vdp_queries_patter.numrows END AS numrows, case WHEN (base_vdp_queries_patter.state = '-') THEN 'SYNTAX_ERROR' ELSE base_vdp_queries_patter.state END AS state, formatdate('yyyy/MM/dd/HH:mm', base_vdp_queries_patter.starttime) AS incomingminute, nullif(base_vdp_queries_patter.completed, false) AS completed, base_vdp_queries_patter.query AS query, nullif(base_vdp_queries_patter.cache, false) AS cached, base_vdp_queries_patter.searchstartdate_0 AS searchstartdate_0, base_vdp_queries_patter.searchenddate_0 AS searchenddate_0 FROM base_vdp_queries_patter;

